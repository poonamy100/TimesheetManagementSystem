@model IEnumerable<TimesheetManagementDAL.Models.AppUser>

@{
  var context = ViewBag.Context as TimesheetManagementDAL.Data.AppDbContext;
}

<head>
  <style>
    section {
      padding: 7px 15px 7px 15px;
    }
  </style>
</head>

<section>
<ul class="nav nav-tabs">
  <li class="nav-item">
    <a asp-area="" asp-controller="ManageData" asp-action="ViewUsers" class="nav-link active" aria-current="page">Users</a>
  </li>
  <li class="nav-item">
    <a asp-area="" asp-controller="ManageData" asp-action="ViewLocations" class="nav-link">Locations</a>
  </li>
  <li class="nav-item">
    <a asp-area="" asp-controller="ManageData" asp-action="ViewSectors" class="nav-link">Sectors</a>
  </li>
</ul>
</section>


<section>
  <button type="button" class="btn btn-dark">
    <a asp-area="Identity" asp-page="/Account/Register">Add New User</a>
  </button>
</section>

<section>
<table class="table table-dark table-striped">
  <thead>
    <tr>
      <th scope="col">Firstname</th>
      <th scope="col">LastName</th>
      <th scope="col">Location</th>
      <th scope="col">Sector</th>
      <th scope="col">Manage</th>
    <tr>
  <thead>
  <tbody>
      @foreach(var user in Model)
      {
        <tr>
          <td>@Html.DisplayFor(modelItem => @user.FirstName)</td>
          <td>@Html.DisplayFor(modelItem => @user.LastName)</td>
          
          @{var Location = await context.Locations.FirstOrDefaultAsync(L => L.Id == user.LocationId);}
          <td>@Html.DisplayFor(modelItem => Location.Address)</td>
          
          @{var Sector = await context.Sectors.FirstOrDefaultAsync(L => L.Id == Location.SectorId);}
          <td>@Html.DisplayFor(modelItem => Sector.Name)</td>

          <td>
            <form asp-controller="ManageData" asp-action="DeleteUser">
              <button type="submit" class="btn btn-danger" name="Id" value="@user.Id">Delete</button>
            </form>
          </td>
        </tr>
      }
  </tbody>
</table>
</section>

